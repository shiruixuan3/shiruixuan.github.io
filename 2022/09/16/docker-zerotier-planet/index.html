<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.1.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/all.min.css" integrity="sha256-jTIdiMuX/e3DGJUGwl3pKSxuc6YOuqtJYkM0bGQESA4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"shiruixuan.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.10.1","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="1：ZeroTier 介绍 2：为什么要自建PLANET 服务器 3：开始安装 3.1：准备条件 3.2：下载项目源码 3.3：执行安装脚本 3.4 下载 planet 文件 3.5 新建网络 3.5.1 创建网络     4.客户端配置 4.1 Windows 配置 4.2 加入网络   4.2 Linux 客户端 4.3 安卓客户端配置 4.4 MacOS 客户端配置   参考链接 5. 管">
<meta property="og:type" content="article">
<meta property="og:title" content="搭建私有 ZeroTier Planet 根服务器（Docker 版）">
<meta property="og:url" content="https://shiruixuan.github.io/2022/09/16/docker-zerotier-planet/index.html">
<meta property="og:site_name" content="shiruixuan">
<meta property="og:description" content="1：ZeroTier 介绍 2：为什么要自建PLANET 服务器 3：开始安装 3.1：准备条件 3.2：下载项目源码 3.3：执行安装脚本 3.4 下载 planet 文件 3.5 新建网络 3.5.1 创建网络     4.客户端配置 4.1 Windows 配置 4.2 加入网络   4.2 Linux 客户端 4.3 安卓客户端配置 4.4 MacOS 客户端配置   参考链接 5. 管">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://gh.api.99988866.xyz/http://raw.githubusercontent.com/shiruixuan/imagehost/main/asserts/zerotier-network.png">
<meta property="og:image" content="http://gh.api.99988866.xyz/http://raw.githubusercontent.com/shiruixuan/imagehost/main/asserts/ztncui.png">
<meta property="og:image" content="http://gh.api.99988866.xyz/http://raw.githubusercontent.com/shiruixuan/imagehost/main/asserts/ztncui_create_net.png">
<meta property="og:image" content="http://gh.api.99988866.xyz/http://raw.githubusercontent.com/shiruixuan/imagehost/main/asserts/ztncui_net_id.png">
<meta property="og:image" content="http://gh.api.99988866.xyz/http://raw.githubusercontent.com/shiruixuan/imagehost/main/asserts/service.png">
<meta property="og:image" content="http://gh.api.99988866.xyz/http://raw.githubusercontent.com/shiruixuan/imagehost/main/asserts/restart_service.png">
<meta property="og:image" content="http://gh.api.99988866.xyz/http://raw.githubusercontent.com/shiruixuan/imagehost/main/asserts/join_net.png">
<meta property="article:published_time" content="2022-09-16T07:46:00.000Z">
<meta property="article:modified_time" content="2022-10-28T11:38:13.908Z">
<meta property="article:author" content="shiruixuan">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://gh.api.99988866.xyz/http://raw.githubusercontent.com/shiruixuan/imagehost/main/asserts/zerotier-network.png">


<link rel="canonical" href="https://shiruixuan.github.io/2022/09/16/docker-zerotier-planet/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://shiruixuan.github.io/2022/09/16/docker-zerotier-planet/","path":"2022/09/16/docker-zerotier-planet/","title":"搭建私有 ZeroTier Planet 根服务器（Docker 版）"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>搭建私有 ZeroTier Planet 根服务器（Docker 版） | shiruixuan</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">shiruixuan</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1%EF%BC%9AZeroTier-%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.</span> <span class="nav-text">1：ZeroTier 介绍</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2%EF%BC%9A%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E8%87%AA%E5%BB%BAPLANET-%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="nav-number">2.</span> <span class="nav-text">2：为什么要自建PLANET 服务器</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3%EF%BC%9A%E5%BC%80%E5%A7%8B%E5%AE%89%E8%A3%85"><span class="nav-number">3.</span> <span class="nav-text">3：开始安装</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1%EF%BC%9A%E5%87%86%E5%A4%87%E6%9D%A1%E4%BB%B6"><span class="nav-number">3.1.</span> <span class="nav-text">3.1：准备条件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2%EF%BC%9A%E4%B8%8B%E8%BD%BD%E9%A1%B9%E7%9B%AE%E6%BA%90%E7%A0%81"><span class="nav-number">3.2.</span> <span class="nav-text">3.2：下载项目源码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-3%EF%BC%9A%E6%89%A7%E8%A1%8C%E5%AE%89%E8%A3%85%E8%84%9A%E6%9C%AC"><span class="nav-number">3.3.</span> <span class="nav-text">3.3：执行安装脚本</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-4-%E4%B8%8B%E8%BD%BD-planet-%E6%96%87%E4%BB%B6"><span class="nav-number">3.4.</span> <span class="nav-text">3.4 下载 planet 文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-5-%E6%96%B0%E5%BB%BA%E7%BD%91%E7%BB%9C"><span class="nav-number">3.5.</span> <span class="nav-text">3.5 新建网络</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-1-%E5%88%9B%E5%BB%BA%E7%BD%91%E7%BB%9C"><span class="nav-number">3.5.1.</span> <span class="nav-text">3.5.1 创建网络</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE"><span class="nav-number">4.</span> <span class="nav-text">4.客户端配置</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1-Windows-%E9%85%8D%E7%BD%AE"><span class="nav-number">4.1.</span> <span class="nav-text">4.1 Windows 配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-%E5%8A%A0%E5%85%A5%E7%BD%91%E7%BB%9C"><span class="nav-number">4.1.1.</span> <span class="nav-text">4.2 加入网络</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2-Linux-%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="nav-number">4.2.</span> <span class="nav-text">4.2 Linux 客户端</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-3-%E5%AE%89%E5%8D%93%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE"><span class="nav-number">4.3.</span> <span class="nav-text">4.3 安卓客户端配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-4-MacOS-%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE"><span class="nav-number">4.4.</span> <span class="nav-text">4.4 MacOS 客户端配置</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5"><span class="nav-number">5.</span> <span class="nav-text">参考链接</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-%E7%AE%A1%E7%90%86%E9%9D%A2%E6%9D%BFSSL%E9%85%8D%E7%BD%AE"><span class="nav-number">6.</span> <span class="nav-text">5. 管理面板SSL配置</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#6-Q-amp-A"><span class="nav-number">7.</span> <span class="nav-text">6:Q&amp;A:</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-Q%EF%BC%9A%E4%B8%BA%E4%BB%80%E4%B9%88%E6%88%91ping%E4%B8%8D%E9%80%9A%E7%9B%AE%E6%A0%87%E6%9C%BA%E5%99%A8%EF%BC%9F"><span class="nav-number">7.1.</span> <span class="nav-text">1. Q：为什么我ping不通目标机器？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-Q%EF%BC%9AIOS%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%80%8E%E4%B9%88%E7%94%A8%EF%BC%9F"><span class="nav-number">7.2.</span> <span class="nav-text">2. Q：IOS客户端怎么用？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-Q-%E4%B8%BA%E4%BB%80%E4%B9%88%E7%9C%8B%E4%B8%8D%E5%88%B0%E5%AE%98%E6%96%B9%E7%9A%84Planet"><span class="nav-number">7.3.</span> <span class="nav-text">3. Q: 为什么看不到官方的Planet</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-Q%EF%BC%9A%E6%88%91%E6%9B%B4%E6%8D%A2%E4%BA%86IP%E9%9C%80%E8%A6%81%E6%80%8E%E4%B9%88%E5%A4%84%E7%90%86%EF%BC%9F"><span class="nav-number">7.4.</span> <span class="nav-text">4. Q：我更换了IP需要怎么处理？</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">shiruixuan</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">1</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://shiruixuan.github.io/2022/09/16/docker-zerotier-planet/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="shiruixuan">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="shiruixuan">
      <meta itemprop="description" content="">
    </span>
    
    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="搭建私有 ZeroTier Planet 根服务器（Docker 版） | shiruixuan">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          搭建私有 ZeroTier Planet 根服务器（Docker 版）
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-09-16 15:46:00" itemprop="dateCreated datePublished" datetime="2022-09-16T15:46:00+08:00">2022-09-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-10-28 19:38:13" itemprop="dateModified" datetime="2022-10-28T19:38:13+08:00">2022-10-28</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <ul>
<li><a href="#1zerotier-%E4%BB%8B%E7%BB%8D">1：ZeroTier 介绍</a></li>
<li><a href="#2%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E8%87%AA%E5%BB%BAplanet-%E6%9C%8D%E5%8A%A1%E5%99%A8">2：为什么要自建PLANET 服务器</a></li>
<li><a href="#3%E5%BC%80%E5%A7%8B%E5%AE%89%E8%A3%85">3：开始安装</a><ul>
<li><a href="#31%E5%87%86%E5%A4%87%E6%9D%A1%E4%BB%B6">3.1：准备条件</a></li>
<li><a href="#32%E4%B8%8B%E8%BD%BD%E9%A1%B9%E7%9B%AE%E6%BA%90%E7%A0%81">3.2：下载项目源码</a></li>
<li><a href="#33%E6%89%A7%E8%A1%8C%E5%AE%89%E8%A3%85%E8%84%9A%E6%9C%AC">3.3：执行安装脚本</a></li>
<li><a href="#34-%E4%B8%8B%E8%BD%BD-planet-%E6%96%87%E4%BB%B6">3.4 下载 <code>planet</code> 文件</a></li>
<li><a href="#35-%E6%96%B0%E5%BB%BA%E7%BD%91%E7%BB%9C">3.5 新建网络</a><ul>
<li><a href="#351-%E5%88%9B%E5%BB%BA%E7%BD%91%E7%BB%9C">3.5.1 创建网络</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#4%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE">4.客户端配置</a><ul>
<li><a href="#41-windows-%E9%85%8D%E7%BD%AE">4.1 Windows 配置</a><ul>
<li><a href="#42-%E5%8A%A0%E5%85%A5%E7%BD%91%E7%BB%9C">4.2 加入网络</a></li>
</ul>
</li>
<li><a href="#42-linux-%E5%AE%A2%E6%88%B7%E7%AB%AF">4.2 Linux 客户端</a></li>
<li><a href="#43-%E5%AE%89%E5%8D%93%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE">4.3 安卓客户端配置</a></li>
<li><a href="#44-macos-%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE">4.4 MacOS 客户端配置</a></li>
</ul>
</li>
<li><a href="#%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5">参考链接</a></li>
<li><a href="#5-%E7%AE%A1%E7%90%86%E9%9D%A2%E6%9D%BFssl%E9%85%8D%E7%BD%AE">5. 管理面板SSL配置</a></li>
<li><a href="#6qa">6:Q&amp;A:</a><ul>
<li><a href="#1-q%E4%B8%BA%E4%BB%80%E4%B9%88%E6%88%91ping%E4%B8%8D%E9%80%9A%E7%9B%AE%E6%A0%87%E6%9C%BA%E5%99%A8">1. Q：为什么我ping不通目标机器？</a></li>
<li><a href="#2-qios%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%80%8E%E4%B9%88%E7%94%A8">2. Q：IOS客户端怎么用？</a></li>
<li><a href="#3-q-%E4%B8%BA%E4%BB%80%E4%B9%88%E7%9C%8B%E4%B8%8D%E5%88%B0%E5%AE%98%E6%96%B9%E7%9A%84planet">3. Q: 为什么看不到官方的Planet</a></li>
<li><a href="#4-q%E6%88%91%E6%9B%B4%E6%8D%A2%E4%BA%86ip%E9%9C%80%E8%A6%81%E6%80%8E%E4%B9%88%E5%A4%84%E7%90%86">4. Q：我更换了IP需要怎么处理？</a></li>
</ul>
</li>
</ul>
<h1 id="1：ZeroTier-介绍"><a href="#1：ZeroTier-介绍" class="headerlink" title="1：ZeroTier 介绍"></a>1：ZeroTier 介绍</h1><p><code>ZeroTier</code> 这一类 P2P VPN 是在互联网的基础上将自己的所有设备组成一个私有的网络，可以理解为互联网连接的局域网。最常见的场景就是在公司可以用手机直接访问家里的 NAS，而且是点对点直连，数据传输并不经由第三方服务器中转。</p>
<p>Zerotier 在多设备之间建立了一个 <code>Peer to Peer VPN（P2PVPN）</code> 连接，如：在笔记本电脑、台式机、嵌入式设备、云资源和应用。这些设备只需要通过 <code>ZeroTier One</code> ( <code>ZeroTier</code> 的客户端) 在不同设备之间建立直接连接，即使它们位于 <code>NAT</code> 之后。连接到虚拟 LAN 的任何计算机和设备通常通过 <code>NAT</code> 或路由器设备与 <code>Internet</code> 连接，<code>ZeroTier One</code> 使用 <code>STUN</code> 和隧道来建立 <code>NAT</code> 后设备之间的 VPN 直连。</p>
<p>简单一点说，<code>Zerotier</code> 就是通过 <code>P2P</code> 等方式实现形如交换机或路由器上 <code>LAN</code>   设备的内网互联。</p>
<p><img src="http://gh.api.99988866.xyz/http://raw.githubusercontent.com/shiruixuan/imagehost/main/asserts/zerotier-network.png" alt="zerotier"></p>
<p><strong>专有名词</strong></p>
<p><code>PLANET</code> <code>：行星服务器，Zerotier</code> 根服务器</p>
<p><code>MOON</code> ：卫星服务器，用户自建的私有根服务器，起到代理加速的作用</p>
<p><code>LEAF</code> ：网络客户端，就是每台连接到网络节点。</p>
<p>我们本次搭建的就是 <code>PLANET</code> 行星服务器</p>
<h1 id="2：为什么要自建PLANET-服务器"><a href="#2：为什么要自建PLANET-服务器" class="headerlink" title="2：为什么要自建PLANET 服务器"></a>2：为什么要自建PLANET 服务器</h1><p>简单来讲就是官方的服务器在海外，我们连接的时候会存在不稳定的情况</p>
<h1 id="3：开始安装"><a href="#3：开始安装" class="headerlink" title="3：开始安装"></a>3：开始安装</h1><h2 id="3-1：准备条件"><a href="#3-1：准备条件" class="headerlink" title="3.1：准备条件"></a>3.1：准备条件</h2><ul>
<li>具有公网 <code>ip</code> 的服务器（需要开放 3443&#x2F;tcp 端口，9993&#x2F;tcp 端口，9993&#x2F;udp 端口）</li>
<li>安装 <code>docker</code></li>
</ul>
<h2 id="3-2：下载项目源码"><a href="#3-2：下载项目源码" class="headerlink" title="3.2：下载项目源码"></a>3.2：下载项目源码</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone http://gh.api.99988866.xyz/http://github.com/shiruixuan/docker-zerotier-planet.git --depth 1</span><br></pre></td></tr></table></figure>
<h2 id="3-3：执行安装脚本"><a href="#3-3：执行安装脚本" class="headerlink" title="3.3：执行安装脚本"></a>3.3：执行安装脚本</h2><p>进入项目目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd docker-zerotier-planet</span><br></pre></td></tr></table></figure>

<p>运行 <code>deploy.sh</code> 脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./deploy.sh</span><br></pre></td></tr></table></figure>

<p>根据提示来选择即可，操作完成后会自动部署</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-------------------------------------------</span><br><span class="line">您当前公网ip为：8.8.8.8, 使用当前ip请输入:y</span><br><span class="line">-------------------------------------------</span><br><span class="line">使用其他ip请输入要使用的ip,例如1.1.1.1</span><br><span class="line">-------------------------------------------</span><br></pre></td></tr></table></figure>

<p>整个脚本预计需要 3-10 分钟,具体需要看网络与机型</p>
<p>当您看到类似如下字样时，表示安装成功</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Step 6/6 : CMD /bin/sh -c &quot;zerotier-one -d; cd /opt/ztncui/src;npm start&quot;</span><br><span class="line"> ---&gt; Running in 13b4acf043ce</span><br><span class="line">Removing intermediate container 13b4acf043ce</span><br><span class="line"> ---&gt; f66b3f73437e</span><br><span class="line">Successfully built f66b3f73437e</span><br><span class="line">Successfully tagged zerotier-planet:latest</span><br><span class="line">启动服务</span><br><span class="line">WARNING: Published ports are discarded when using host network mode</span><br><span class="line">7782066b89fb217bf53ae57b139c73c3d6df79fecf887d1571aa8eed2433ba75</span><br></pre></td></tr></table></figure>


<h2 id="3-4-下载-planet-文件"><a href="#3-4-下载-planet-文件" class="headerlink" title="3.4 下载 planet 文件"></a>3.4 下载 <code>planet</code> 文件</h2><p>脚本运行完成后，会在 <code>/opt/</code> 目录下有个 <code>planet</code> 文件</p>
<p>下载该文件以备用</p>
<h2 id="3-5-新建网络"><a href="#3-5-新建网络" class="headerlink" title="3.5 新建网络"></a>3.5 新建网络</h2><p>访问 <code>http://ip:3443</code> 进入controller页面</p>
<p><img src="http://gh.api.99988866.xyz/http://raw.githubusercontent.com/shiruixuan/imagehost/main/asserts/ztncui.png" alt="ui"></p>
<p>使用默认账号为:<code>admin</code></p>
<p>默认密码为:<code>password</code></p>
<h3 id="3-5-1-创建网络"><a href="#3-5-1-创建网络" class="headerlink" title="3.5.1 创建网络"></a>3.5.1 创建网络</h3><p>进入后创建一个网络，可以得到一个网络ID</p>
<p>创建网络，输入名称</p>
<p><img src="http://gh.api.99988866.xyz/http://raw.githubusercontent.com/shiruixuan/imagehost/main/asserts/ztncui_create_net.png" alt="ui"></p>
<p>得到网络 <code>id</code></p>
<p><img src="http://gh.api.99988866.xyz/http://raw.githubusercontent.com/shiruixuan/imagehost/main/asserts/ztncui_net_id.png" alt="ui"></p>
<h1 id="4-客户端配置"><a href="#4-客户端配置" class="headerlink" title="4.客户端配置"></a>4.客户端配置</h1><p>客户端主要为Windows, Mac, Linux, Android</p>
<h2 id="4-1-Windows-配置"><a href="#4-1-Windows-配置" class="headerlink" title="4.1 Windows 配置"></a>4.1 Windows 配置</h2><p>首先去zerotier官网下载一个zerotier客户端</p>
<p>将 <code>planet</code> 文件覆盖粘贴到<code>C:\ProgramData\ZeroTier\One</code>中(这个目录是个隐藏目录，需要运允许查看隐藏目录才行)</p>
<p>Win+S 搜索 <code>服务</code></p>
<p><img src="http://gh.api.99988866.xyz/http://raw.githubusercontent.com/shiruixuan/imagehost/main/asserts/service.png" alt="ui"></p>
<p>找到ZeroTier One，并且重启服务</p>
<p><img src="http://gh.api.99988866.xyz/http://raw.githubusercontent.com/shiruixuan/imagehost/main/asserts/restart_service.png" alt="ui"></p>
<h3 id="4-2-加入网络"><a href="#4-2-加入网络" class="headerlink" title="4.2 加入网络"></a>4.2 加入网络</h3><p>使用管理员身份打开PowerShell</p>
<p>执行如下命令，看到join ok字样就成功了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Windows\system32&gt; zerotier-cli.bat join 网络id(就是在网页里面创建的那个网络)</span><br><span class="line">200 join OK</span><br><span class="line">PS C:\Windows\system32&gt;</span><br></pre></td></tr></table></figure>

<p>登录管理后台可以看到有个个新的客户端，勾选Authorized就行</p>
<p><img src="http://gh.api.99988866.xyz/http://raw.githubusercontent.com/shiruixuan/imagehost/main/asserts/join_net.png" alt="ui"></p>
<p>执行如下命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Windows\system32&gt; zerotier-cli.bat peers</span><br><span class="line">200 peers</span><br><span class="line">&lt;ztaddr&gt;   &lt;ver&gt;  &lt;role&gt; &lt;lat&gt; &lt;link&gt; &lt;lastTX&gt; &lt;lastRX&gt; &lt;path&gt;</span><br><span class="line">fcbaeb9b6c 1.8.7  PLANET    52 DIRECT 16       8994     1.1.1.1/9993</span><br><span class="line">fe92971aad 1.8.7  LEAF      14 DIRECT -1       4150     2.2.2.2/9993</span><br><span class="line">PS C:\Windows\system32&gt;</span><br></pre></td></tr></table></figure>
<p>可以看到有一个 PLANTET 和 LEAF 角色，连接方式均为 DIRECT(直连)</p>
<p>到这里就加入网络成功了</p>
<h2 id="4-2-Linux-客户端"><a href="#4-2-Linux-客户端" class="headerlink" title="4.2 Linux 客户端"></a>4.2 Linux 客户端</h2><p>步骤如下：</p>
<ol>
<li>安装linux客户端软件</li>
<li>进入目录 <code>/var/lib/zerotier-one</code></li>
<li>替换目录下的 <code>planet</code> 文件</li>
<li>重启 <code>zerotier-one</code> 服务(<code>service zerotier-one restart</code>)</li>
<li>加入网络 <code>zerotier-cli join</code> 网络 <code>id</code></li>
<li>管理后台同意加入请求</li>
<li><code>zerotier-cli peers</code> 可以看到<code> planet</code> 角色</li>
</ol>
<h2 id="4-3-安卓客户端配置"><a href="#4-3-安卓客户端配置" class="headerlink" title="4.3 安卓客户端配置"></a>4.3 安卓客户端配置</h2><p><a target="_blank" rel="noopener" href="https://www.v2ex.com/t/768628">Zerotier 非官方安卓客户端发布：支持自建 Moon 节点 - V2EX</a></p>
<h2 id="4-4-MacOS-客户端配置"><a href="#4-4-MacOS-客户端配置" class="headerlink" title="4.4 MacOS 客户端配置"></a>4.4 MacOS 客户端配置</h2><p>步骤如下：</p>
<ol>
<li>进入 <code>/Library/Application\ Support/ZeroTier/One/</code> 目录，并替换目录下的 <code>planet</code> 文件</li>
<li>重启 ZeroTier-One：<code>cat /Library/Application\ Support/ZeroTier/One/zerotier-one.pid | sudo xargs kill</code></li>
<li>加入网络 <code>zerotier-cli join</code> 网络 <code>id</code></li>
<li>管理后台同意加入请求</li>
<li><code>zerotier-cli peers</code> 可以看到<code> planet</code> 角色</li>
</ol>
<h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><p><a target="_blank" rel="noopener" href="https://www.glimmer.ltd/2021/3299983056/">zerotier-虚拟局域网详解</a></p>
<p><a target="_blank" rel="noopener" href="https://v2ex.com/t/799623">五分钟自建 ZeroTier 的 Planet&#x2F;Controller</a></p>
<h1 id="5-管理面板SSL配置"><a href="#5-管理面板SSL配置" class="headerlink" title="5. 管理面板SSL配置"></a>5. 管理面板SSL配置</h1><p>管理面板的SSL支持需要自行配置，参考Nginx配置如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">upstream zerotier &#123;</span><br><span class="line">  server 127.0.0.1: 3443;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line"></span><br><span class="line">  listen 443 ssl;</span><br><span class="line"></span><br><span class="line">  server_name &#123;CUSTOME_DOMAIN&#125;; #替换自己的域名</span><br><span class="line"></span><br><span class="line">  # ssl证书地址</span><br><span class="line">  ssl_certificate    pem和或者crt文件的路径;</span><br><span class="line">  ssl_certificate_key key文件的路径;</span><br><span class="line"></span><br><span class="line">  # ssl验证相关配置</span><br><span class="line">  ssl_session_timeout  5m;    #缓存有效期</span><br><span class="line">  ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;    #加密算法</span><br><span class="line">  ssl_protocols TLSv1 TLSv1.1 TLSv1.2;    #安全链接可选的加密协议</span><br><span class="line">  ssl_prefer_server_ciphers on;   #使用服务器端的首选算法</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  location / &#123;</span><br><span class="line">    proxy_pass http: //zerotier;</span><br><span class="line">    proxy_set_header HOST $host;</span><br><span class="line">    proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class="line">    proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen       80;</span><br><span class="line">    server_name  &#123;CUSTOME_DOMAIN&#125;; //替换自己的域名</span><br><span class="line">    return 301 https: //$server_name$request_uri;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="6-Q-amp-A"><a href="#6-Q-amp-A" class="headerlink" title="6:Q&amp;A:"></a>6:Q&amp;A:</h1><h2 id="1-Q：为什么我ping不通目标机器？"><a href="#1-Q：为什么我ping不通目标机器？" class="headerlink" title="1. Q：为什么我ping不通目标机器？"></a>1. Q：为什么我ping不通目标机器？</h2><p>A：请检查防火墙设置，<code>Windows</code> 系统需要允许 <code>ICMP</code> 入站，<code>Linux</code> 同理</p>
<h2 id="2-Q：IOS客户端怎么用？"><a href="#2-Q：IOS客户端怎么用？" class="headerlink" title="2. Q：IOS客户端怎么用？"></a>2. Q：IOS客户端怎么用？</h2><p>A：我也不知道</p>
<h2 id="3-Q-为什么看不到官方的Planet"><a href="#3-Q-为什么看不到官方的Planet" class="headerlink" title="3. Q: 为什么看不到官方的Planet"></a>3. Q: 为什么看不到官方的Planet</h2><p>A: 该项目剔除了官方服务器，只保留了自定义的Planet节点</p>
<h2 id="4-Q：我更换了IP需要怎么处理？"><a href="#4-Q：我更换了IP需要怎么处理？" class="headerlink" title="4. Q：我更换了IP需要怎么处理？"></a>4. Q：我更换了IP需要怎么处理？</h2><p>A: 如果IP更换了，则需要重新部署，相当于全新部署</p>

    </div>

    
    
    

    <footer class="post-footer">

        

    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="author" itemprop="copyrightHolder">shiruixuan</span>
</div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  





  





</body>
</html>
